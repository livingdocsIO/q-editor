<template>
  <require from="./tasks.css"></require>
  <require from="../elements/schema-editor/schema-editor"></require>
  <q-bar if.bind="user.isLoggedIn" router.bind="router">
    <icon-logo class="index__logo" if.bind="enoughNewItems" slot="logo" click.delegate="reloadItems()"></icon-logo>
    <icon-m class="index__logo" if.bind="!enoughNewItems" slot="logo" click.delegate="reloadItems()"></icon-m>
    <language-switcher slot="language-switcher"></language-switcher>
    <button-secondary slot="account-button" if.bind="user.isLoggedIn" click.delegate="showAccountModal()">${user.data.initials}</button-secondary>
  </q-bar>
  <section class="tasks">
    <div id="tasks--sidebar">
      <ul id="tasks--list">
         <li repeat.for="task of tasks"><a click.delegate="loadTask(task)" class="q-text-small">${task.name}</a></li>
      </ul>
    </div>
    <div id="tasks--input">
      <p class="s-font-sans s-font-title">${selectedTask.name}</p>
      <schema-editor schema.bind="selectedTask.schema || {}" data.bind="taskInput"></schema-editor>
      <button-primary click.delegate="executeTask(task)" icon="">Ausführen</button-primary>
    </div>
    <div id="tasks--output">
      <div if.bind="output.type==='json'">
        <div repeat.for="item of output.data">
          <p class="s-font-sans s-font-title">${item.label}</p>
          <div>
            <pre class="tasks--output--json" style="">${item.content | json:2}</pre>
          </div>
        </div>
      </div>
    </div>
  </section>
</template>
